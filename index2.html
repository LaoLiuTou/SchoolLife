<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<title>表白墙</title>
		<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="black" name="apple-mobile-web-app-status-bar-style">
		<meta content="telephone=no" name="format-detection">
		<link rel="stylesheet" href="css/weui.css">
		<link rel="stylesheet" href="css/jquery-weui.css">
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" type="text/css" href="css/swipeslider.css">
		<link rel="stylesheet" href="css/baguetteBox.css">
		<link rel="stylesheet" type="text/css" href="css/dianzstyle.css"/>
	</head>

	<body>
		<div class="weui-tab">
			<div class="weui-navbar bbqwid90" id="main_nav">
				<div  class="indexreturn">
					<img src="images/houtui-icon.png" />
				</div>
				<a class="weui-navbar__item weui-bar__item--on textri" href="#tab1">
					<div class="bbqtab">
						<p>校园表白墙</p>
						<div class="bbqtabblue"></div>
					</div>
				</a>
				<a class="weui-navbar__item textle" href="#tab2">
					<div class="bbqtab">
						<p>话题广场</p>
						<div class="bbqtabblue"></div>
					</div>
				</a>
				<a class="indexreturnsou" href="search.html">
					<img src="images/sousuo-icon.png" />
				</a>
			</div>
			<div class="bbqbanner">
				<figure id="full_feature" class="swipslider">
					<ul class="sw-slides">
						<li class="sw-slide">
							<img src="images/bbqbanner.png">
						</li>
					</ul>
				</figure>
			</div>
			<div class="weui-tab__bd">
				<ul id="tab1" class="weui-tab__bd-item weui-tab__bd-item--active bbqul">
					<a href="user_details.html">
					<li class="bbqlist">
						<div class="bbqlistimg">
							<img src="images/9f10f09c24c4611808bcccd9b5302a3.jpg">
						</div>
						<!--认证-->
						<img class="renzicon" src="images/renzheng-left-icon.png">
						<img class="renzicons" src="images/renzheng-right-icon.png">
						<div class="bbqlistword">
							<p class="bbqname"><span class="vermiddle">我叫马铃薯</span><img class="bbqxb" src="images/nv-icon.png"></p>
							<p class="bbqtime">2分钟以前</p>
							<p class="bbqneir">我今天九年级了，我还得上补课班，我最爱吃冰激凌啦！</p>
							<div class="baguetteBoxOne  bbqlistimgs" >
						        <a style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" class="listimgs" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg" >
						        </a>
						        <a style="background-image: url(images/f829f187ae0acce4e1e8752cfc8e9f2.jpg);" class="listimgs" href="images/f829f187ae0acce4e1e8752cfc8e9f2.jpg" >
						        </a>
						        <a style="background-image: url(images/bbqbanner.png);"  class="listimgs" href="images/bbqbanner.png">
						        </a>
						    </div>
						    <p class="bbqindexbiaoq">#我是标签</p>
							<div class="bbqbuttonthree posire">
								<div class="heart " id="like1" rel="like"></div>
								<span class="bbqbuttonspan likespan" id="likeCount1">99</span>
								<span class="locationpl">
									<img src="images/pinglun-icon.png" />
									<span class="bbqbuttonspan">999+</span>
								</span>
								<img class="fr bbqgengdtc" src="images/gengduo.png" />
							</div>
							
							
							
						</div>
						<!--热门标签-->
						<div class="bbqremen"><img src="images/remen.png"></div>
					</li>
					</a>
					<li class="bbqlist">
						<div class="bbqlistimg">
							<img src="images/9f10f09c24c4611808bcccd9b5302a3.jpg">
						</div>
						<div class="bbqlistword">
							<p class="bbqname"><span class="vermiddle">我叫马铃薯</span><img class="bbqxb" src="images/nan-icon.png"></p>
							<p class="bbqtime">2分钟以前</p>
							<p class="bbqneir">我今天九年级了，我还得上补课班，我最爱吃冰激凌啦！</p>
							<div class="baguetteBoxOne  bbqlistimgs" >
						        <a class="listimgs" style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg" >
						        </a>
						        <a class="listimgs" style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg" >
						        </a>
						        <a class="listimgs" style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg">
						        </a>
						    </div>
						    <div class="bbqbuttonthree posire">
								<div class="heart"  id="like2"  rel="like"></div>
								<span class="bbqbuttonspan likespan" >99</span>
								<span class="locationpl">
									<img src="images/pinglun-icon.png" />
									<span class="bbqbuttonspan">999+</span>
								</span>
								<img class="fr bbqgengdtc" src="images/gengduo.png" />
							</div>
						</div>
					</li>
				</ul>
				<!--话题广场-->
				<ul id="tab2" class="weui-tab__bd-item bbqul">
					<li class="bbqlist">
						<div class="bbqlistimg">
							<img src="images/9f10f09c24c4611808bcccd9b5302a3.jpg">
						</div>
						<div class="bbqlistword">
							<p class="bbqname"><span class="vermiddle">我叫马铃薯</span><img class="bbqxb" src="images/nan-icon.png"></p>
							<span class="bbqtime">2分钟以前</span>
							<span class="bbqtime">
								<img class="bbqwz" src="images/indexwz-icon.png">吉林大学
							</span>
							<p class="bbqneir">我今天九年级了，我还得上补课班，我最爱吃冰激凌啦！</p>
							<div class="baguetteBoxOne  bbqlistimgs" >
						        <a class="listimgs" style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg" >
						        </a>
						        <a class="listimgs" style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg" >
						        </a>
						        <a class="listimgs" style="background-image: url(images/9f10f09c24c4611808bcccd9b5302a3.jpg);" href="images/9f10f09c24c4611808bcccd9b5302a3.jpg">
						        </a>
						    </div>
						    
							<div class="bbqbuttonthree">
								<span>
									<img src="images/dianza-icon-wdj.png" />
									<span class="bbqbuttonspan">999+</span>
								</span>
								<span class="locationpl">
									<img src="images/pinglun-icon.png" />
									<span class="bbqbuttonspan">999+</span>
								</span>
								<img class="fr bbqgengdtc" src="images/gengduo.png" />
							</div>
						</div>
					</li>
					
				</ul>
			</div>
			<div class="weui-flex weui-fixed-btm">
				<div class="weui-flex__item">
					<a href="javascript:;" class="weui-fixed-btn">
						<img src="images/biaobq-icon.png">
						<p>表白墙</p>
					</a>
				</div>
				<div class="weui-flex__item posire">
					<div class="weui-fixed-btn">
						<div class="h30"></div>
						<p>发布</p>
					</div>
					<div class="bbqfb">
						<div class="bbqfbtn" id="bbqfbbtn">
							<img src="images/fabu-icon.png">
						</div>
				  	</div>
				</div>
			
				<div class="weui-flex__item">
					<a href="personal_center.html" class="weui-fixed-btn">
						<img src="images/wode-icon-wdj.png">
						<p>我的</p>
					</a>
				</div>
			</div>
			<!--发布弹出-->
			<div class="bbqfbtanc">
				<div class="fbtanbg">
					<div class="fbtanbtn">
						<a href="publish.html">
						<div class="fbtanbtnw" >
							<div class="fbtanbtnown">
								<img src="images/fabu-wz-icon.png">
							</div>
							文字
						</div></a>
						<div class="fbtanbtnw" id="publish_camera">
							<div class="fbtanbtnown">
								<img src="images/fabu-ps-icon.png">

							</div>
							拍摄
						</div>
						<div class="fbtanbtnw" id="publish_album">
							<div class="fbtanbtnown">
								<img src="images/fabu-xc-icon.png">

							</div>
							相册
						</div>
					</div>
					<div class="bbqfb">
						<div class="bbqfbtn" id="bbqtanchide">
							<img  class="bbqfbguanb" src="images/fabu-icon.png">
						</div>
				  	</div>
				</div>
			</div>
			<!--收藏弹出-->
			<div class="bbqshoucangtanc">
				<img src="images/shoucang-icon.png">
			</div>
			
			<!--更多弹出-->
			<div class="bbqgengdtanc">
				<div class="gengdbg">
					<div class="tit bbqscbtn">收藏</div>
					<div class="tit">举报</div>
					<div class="bbqqxbtn titbtn">取消</div>
				</div>
			</div>
			<!--举报弹出-->
			<div class="bbqjubtanc" style="display: none;">
				<div class="gengdbg">
					<div class="tit">广告或垃圾</div>
					<div class="tit">违反相关法律法规或管理规定</div>
					<div class="tit">引战或过于偏激的主观判断</div>
					<div class="tit">低俗或色情</div>
					<div class="tit">泄露他人隐私</div>
					<div class="tit">其他</div>
					<textarea class="tittext" placeholder="请输入举报内容"></textarea>
					<div class="titbtn">取消</div>
					<div class="titbtn bbqgreen">完成</div>
				</div>
			</div>
		</div>
	</div>




		<!--新建-->
		<div id="publishPop" class="weui-popup__container">
			<div class="weui-popup__overlay"></div>
			<div class="weui-popup__modal bbqfff" style="">
				<div class="head">
					<div   class="bbqguanb"><img src="images/guanbi-icon.png"></div>
					创建话题
					<div  class="operation" id="publish">发布</div>
				</div>

				<div class="bbqfabword bbqwid90">
					<textarea placeholder="晒给懂你的人..."></textarea>
				</div>
				<div class="weui-gallery " id="gallery">
					<span class="weui-gallery__img" id="galleryImg" style="background-image:url(./images/pic_160.png)"></span>
					<div class="weui-gallery__opr">
						<a href="javascript:" class="weui-gallery__del" imageIndex="" id="delgalleryBtn">
							<i class="weui-icon-delete weui-icon_gallery-delete"></i>
						</a>
					</div>
				</div>
				<div class="weui-cells weui-cells_form bbqwid90" style="">
					<div class="weui-cell">
						<div class="weui-cell__bd">
							<div class="weui-uploader">
								<div class="weui-uploader__bd">
									<ul class="weui-uploader__files"  id="uploaderFiles">
									</ul>
									<div class="weui-uploader__input-box">
										<input id="uploaderInput" class="weui-uploader__input" type="file" accept="image/*" multiple="">
									</div>
								</div>
							</div>
						</div>

					</div>
					<div  id="addLabel" style="display: inline-block;">
						<div class="bbqbiaoq">恋爱</div>
						<div class="bbqbiaoq">恋爱恋爱</div>
						<div class="bbqbiaoq">恋爱</div>
					</div>
					<div class="weui-cells weui-cells_checkbox wid100" style="position: initial;padding-bottom: 0.5rem">
						<label class="weui-cell weui-check__label" for="s17">
							<div class="weui-cell__hd">
								<input type="checkbox" class="weui-check" name="checkbox1" id="s17" checked="checked">
								<i class="weui-icon-checked"></i>
							</div>
							<div class="weui-cell__bd">
								<p>仅本校可见</p>
							</div>

						</label>
					</div>
					<div class="weui-cells weui-cells_checkbox wid100"  style="position: initial;">
						<label class="weui-cell weui-check__label" for="s171">
							<div class="weui-cell__hd">
								<input type="checkbox" class="weui-check" name="checkbox1" id="s171" checked="checked">
								<i class="weui-icon-checked"></i>
							</div>
							<div class="weui-cell__bd">
								<p>开启匿名</p>
							</div>

						</label>
					</div>
				</div>

			</div>
		</div>
		

		<script src="js/jquery.min.js"></script>
		<script src="js/jquery-weui.min.js"></script>

		<script type="text/javascript" src="js/swipeslider.min.js"></script>
		<!--图片展开-->
		<script src="js/baguetteBox.js" async></script>
		<script src="js/highlight.min.js" async></script>
		<script src="js/dianzan.js"></script>

		<script type="text/javascript">
            //			轮播图
            /* $(window).load(function() {
                $('#full_feature').swipeslider();
                $('#content_slider').swipeslider({
                    transitionDuration: 600,
                    autoPlayTimeout: 10000,
                    sliderHeight: '300px'
                });
                $('#responsiveness').swipeslider();
                $('#customizability').swipeslider({
                    transitionDuration: 1500,
                    autoPlayTimeout: 4000,
                    timingFunction: 'cubic-bezier(0.38, 0.96, 0.7, 0.07)',
                    sliderHeight: '30%'
                });
            });*/
            //			图片宽高
            $(window).load(function(){
                listimgs = $('.listimgs').width();
                $('.listimgs').height(listimgs);
            });

            //			发布弹出
            $('#bbqfbbtn').click(function(){
                $('.bbqfbtanc').show();
                $('.fbtanbg').height('11rem');
                $('.bbqfbguanb').css({'transform':'rotate(45deg)','transition':'0.2s'})
                $('#bbqtanchide').click(function(){
                    $('.bbqfbtanc').hide();
                })
            });
            $(".bbqgengdtc").click(function(){
                $(".bbqgengdtanc").show();
                $(".bbqqxbtn").click(function(){
                    $('.bbqgengdtanc').hide();
                })

            })
            $(".locationpl").click(function(){
                window.location.href='post_details.html'});
            //			收藏弹出
            $(".bbqscbtn").click(function() {
                $('.bbqshoucangtanc').show();
                $('.bbqgengdtanc').hide();
                setTimeout(function() { //定时器
                        $(".bbqshoucangtanc").css("display", "none");
                    },
                    600);
            });

            window.onload = function() {
                baguetteBox.run('.baguetteBoxOne');
                $('#baguetteBox-overlay').prepend("<div class='bbqtpword bbqwid90'>"+
                    "<span class='tpspan'>123123123123123123123123123123123123123123123123123123<span>"+
                    "<div class='bbqbuttonthree bbqphotobtn'>"+
                    "<img src='images/tp-dianzan.png'>"+
                    "<span class='bbqbuttonspan'>99</span>"+
                    "<span class='locationpl'>"+
                    "<img src='images/tp-pinglun.png'>"+
                    "<span class='bbqbuttonspan'>9999</span>"+
                    "</span>"+
                    "</div></div>"+
                    "<div class='tpzhankbtn'><span>展开</span><img src='images/jiantoubottom-icon.png'></div>");
                $(".tpzhankbtn").click(function(){
                    var spanbtn = $('.tpzhankbtn span').text();
                    if(spanbtn == '展开'){
                        $('.bbqtpword').show();
                        $('.tpzhankbtn img').css({'transform':'rotate(-180deg)','transition':'0.2s'})
                        $('.tpzhankbtn span').text('收起');
                    }else if(spanbtn == "收起"){
                        $('.bbqtpword').hide();
                        $('.tpzhankbtn img').css({'transform':'rotate(0deg)','transition':'0.2s'})
                        $('.tpzhankbtn span').text('展开');
                    }
                })

            };

            var imageArray=[];
            $(function() {
                var tmpl = '<li class="weui-uploader__file" imageIndex="#imageIndex#" style="background-image:url(#url#)"></li>',
                    $gallery = $("#gallery"),
                    $galleryImg = $("#galleryImg"),
                    $uploaderInput = $("#uploaderInput"),
                    $uploaderFiles = $("#uploaderFiles");

                $uploaderInput.on("change", function(e) {
                    var src, url = window.URL || window.webkitURL || window.mozURL,
                        files = e.target.files;
                    for(var i = 0, len = files.length; i < len; ++i) {
                        var file = files[i];

                        if(url) {
                            src = url.createObjectURL(file);
                        } else {
                            src = e.target.result;
                        }
                        imageArray.push(file);
                        var  index=imageArray.indexOf(file);
                        $uploaderFiles.append($(tmpl.replace('#url#', src).replace('#imageIndex#', index)));
                    }
                });
                $uploaderFiles.on("click", "li", function() {
                    $galleryImg.attr("style", this.getAttribute("style"));
                    $gallery.fadeIn(100);
                    $('#delgalleryBtn').attr('imageIndex',$(this).attr("imageIndex"));

                });
                $gallery.on("click", function() {
                    $gallery.fadeOut(100);
                });
                $('#delgalleryBtn').click(function(){
                    console.log(imageArray);
                    var clickIndex=$(this).attr("imageIndex");
                    imageArray.remove(imageArray[clickIndex]);
                    $('#uploaderFiles li').each(function(){
                        if(clickIndex==$(this).attr("imageIndex")){
                            $(this).remove();
						}
					});
                    //console.log(imageArray);
                    //$('#uploaderFiles li[imageIndex="'+$(this).attr("imageIndex")+'"]').text();
				});
            });
		</script>

		<!--具体功能实现-->
		<script type="text/javascript" src="js/main/config.js"></script>
		<script>
            $(document).ready(function () {

                var bodyParam = {'USER_ID': '3361'};
                listBanners(bodyParam);
                var bodyParam = {'USER_ID': '3361','IS_SEE':'0','PAGE':'1'};
                listTalk(bodyParam);

				$('.bbqguanb').click(function(){
                    $('#main_nav').show();
                    $.closePopup();
				});

                $('#publish_camera').on('click',function(){

                    $("#uploaderInput").prop('capture','camera');
                    $("#uploaderInput").click();
                    $("#publishPop").popup();
                    $('#main_nav').hide();
                    $('#bbqtanchide').click();
                });
                $('#publish_album').on('click',function(){
                    $("#uploaderInput").prop('capture','');
                    $("#uploaderInput").click();
                    $("#publishPop").popup();
                    $('#main_nav').hide();
                    $('#bbqtanchide').click();
                });

                $('#publish').click(function(){
                    if(imageArray.length>9){
                        $.toast("最多只能上传9张图片！", "text");
                    }
                    else if(imageArray.length>0&&imageArray.length<=9){
                        var formData = new FormData();

                        for(var o in imageArray){
                            console.log( imageArray[o]);
                            formData.append("image", imageArray[o]);
                        }
                        $.ajax({
                            type: "post",
                            url: url +"uploadImg",
                            //url: 'http://192.168.1.144/FileUS/filesUpload',
                            data: formData,
                            contentType: false, // 注意这里应设为false
                            processData: false,    //false
                            cache: false,    //缓存
                            success: function(response){
                                var obj = JSON.parse(response);
                                var code = obj['Code'];
                                if(code=='1'){
                                    var result = obj['Result'];
                                    var images=result;
                                    console.log(images);
                                }
                                else{
                                    $.toast("上传文件失败！", "text");
                                }
                            }
                        })
                    }


				});



            });


            /**
             * banner
             */
            function listBanners(bodyParam) {
                var hrt = new HttpRequestTool(url + 'cxBanner', 'post', 'text', true, false, bodyParam, 'callBack');
                hrt.HttpRequest(function (response) {
                    var obj = JSON.parse(response);

                    var data = obj['Result'];
                    var html='';

                    for(j = 0,len=data.length; j < len; j++) {
                        html+=' <li class="sw-slide" itemId="'+data[j].ID+'">\n' +
                            '   <img src="'+data[j].BANNER_IMG+'">\n' +
                            '   </li>';
                    }

                    $('.sw-slides').html(html);


                    $('#full_feature').swipeslider();
                    $('#content_slider').swipeslider({
                        transitionDuration: 600,
                        autoPlayTimeout: 10000,
                        sliderHeight: '300px'
                    });
                    $('#responsiveness').swipeslider();
                    $('#customizability').swipeslider({
                        transitionDuration: 1500,
                        autoPlayTimeout: 4000,
                        timingFunction: 'cubic-bezier(0.38, 0.96, 0.7, 0.07)',
                        sliderHeight: '30%'
                    });
                });

            }

            /**
             * 发布话题
             */
            function addTalk(bodyParam) {
                var hrt = new HttpRequestTool(url + 'addTalk', 'post', 'text', true, false, bodyParam, 'callBack');
                hrt.HttpRequest(function (response) {
                    var obj = JSON.parse(response);
                    var result = obj['Result'];
                    console.log(result);
                });
            }

            /**
             * 话题列表
             */
            function listTalk(bodyParam) {
                var hrt = new HttpRequestTool(url + 'cxTalkList', 'post', 'text', true, false, bodyParam, 'callBack');
                hrt.HttpRequest(function (response) {
                    var obj = JSON.parse(response);
                    var result = obj['Result'];
                    console.log(result);
                });
            }





                $('#files').fileinput({
                    theme: 'fa',
                    language: 'zh',
                    uploadAsync: true,//异步上传
                    uploadUrl: uploadUrl+'filesUpload',
                    allowedFileExtensions: ['jpg', 'png', 'gif','mp4'],
                    showUpload: true,
                    showCaption: false,
                    showRemove : false, //显示移除按钮
                    enctype: 'multipart/form-data',
                    maxFileSize:0,
                    maxFileCount:1,
                    dropZoneTitle: '拖拽文件到这里 &hellip;',
                    msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",

                    //overwriteInitial: false, //不覆盖已存在的图片
                    fileActionSettings:{showDrag:false},


                    ////////////////////////////////图片默认值////////////////////////////////////////
					initialPreviewAsData: true,
                    initialPreview: [
                        "http://lorempixel.com/1920/1080/transport/1",
                        "http://lorempixel.com/1920/1080/transport/2",
                        "http://lorempixel.com/1920/1080/transport/3"
                    ],
                    initialPreviewConfig: [
                        {caption: "transport-1.jpg", size: 329892, width: "120px", url: "{$url}", key: 1},
                        {caption: "transport-2.jpg", size: 872378, width: "120px", url: "{$url}", key: 2},
                        {caption: "transport-3.jpg", size: 632762, width: "120px", url: "{$url}", key: 3}
                    ]
                    ////////////////////////////////图片默认值////////////////////////////////////////

                }).on("filebatchselected", function(event, files) {
                    //$(this).fileinput("upload");
                }).on("fileuploaded", function(event,data, previewId, index) { //异步上传成功结果处理

                }).on('filesuccessremove', function (event, previewId,index) {

                }).on('filepredelete', function(event, key, jqXHR, data) {

                }) ;


		</script>
		
	</body>

</html>